# ========== 应用配置 ==========
KIKI_APP_NAME=Kiki Agent
KIKI_APP_VERSION=0.1.0
KIKI_ENVIRONMENT=development
KIKI_DEBUG=true

# ========== 服务器配置 ==========
KIKI_HOST=0.0.0.0
KIKI_PORT=8000
KIKI_API_PREFIX=/api/v1

# ========== 数据库配置 ==========
# 本地开发: Docker 依赖服务启动后，使用此连接字符串
KIKI_DATABASE_URL=postgresql+asyncpg://kiki:kiki_secret@localhost:15432/kiki
KIKI_DATABASE_POOL_SIZE=20
KIKI_DATABASE_ECHO=false

# Docker Compose 环境变量（用于 docker-compose.dev.yml）
KIKI_DATABASE_DB=kiki
KIKI_DATABASE_USER=kiki
KIKI_DATABASE_PASSWORD=kiki_secret
KIKI_DATABASE_PORT=15432

# ========== Redis 配置 ==========
# Redis 连接 URL，支持：
# - 单机: redis://localhost:16379/0
# - 密码: redis://:password@localhost:16379/0
# - Sentinel: redis+sentinel://localhost:26379/mymaster/0
KIKI_REDIS_URL=redis://localhost:16379/0
KIKI_REDIS_POOL_SIZE=10
KIKI_REDIS_SOCKET_TIMEOUT=5.0
KIKI_REDIS_SOCKET_CONNECT_TIMEOUT=5.0
KIKI_REDIS_DECODE_RESPONSES=true

# ========== LLM 配置 ==========
# Provider: openai, anthropic, ollama, dashscope
KIKI_LLM_PROVIDER=openai
KIKI_LLM_MODEL=gpt-4o
KIKI_LLM_TEMPERATURE=0.7
KIKI_LLM_API_KEY=your-openai-api-key-here

# DashScope (阿里云 Qwen) 配置
# KIKI_LLM_PROVIDER=dashscope
# KIKI_LLM_MODEL=qwen-max
# KIKI_DASHSCOPE_API_KEY=your-dashscope-api-key-here
# KIKI_DASHSCOPE_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1

# ========== 认证配置 ==========
# 生产环境请使用强密钥（至少 32 字符）
KIKI_SECRET_KEY=change-me-in-production-min-32-chars
KIKI_ACCESS_TOKEN_EXPIRE_MINUTES=30
KIKI_REFRESH_TOKEN_EXPIRE_DAYS=7
KIKI_JWT_ALGORITHM=HS256

# ========== 多租户配置 ==========
# 租户 API Key 加密密钥（AES-256，32 字节）
# 生成方法: openssl rand -base64 32
KIKI_TENANT_AES_KEY=
# 是否启用跨租户访问（需要用户有 can_access_all_tenants 权限）
KIKI_ENABLE_CROSS_TENANT=false
# 默认存储配额（字节），10GB
KIKI_DEFAULT_STORAGE_QUOTA=10737418240

# ========== 可观测性配置 ==========
KIKI_LOG_LEVEL=INFO
KIKI_LOG_FORMAT=console

# ========== LangSmith 配置 ==========
# LangChain/LangGraph 追踪（用于 LangSmith Studio）
LANGCHAIN_TRACING_V2=false
LANGCHAIN_API_KEY=
LANGCHAIN_PROJECT=kiki-agent
LANGCHAIN_TENANT_ID=

# langsmith-fetch CLI 工具配置（用于调试 Agent 执行追踪）
# 获取 API Key: https://smith.langchain.com/settings
LANGSMITH_API_KEY=$LANGCHAIN_API_KEY
LANGSMITH_PROJECT=$LANGCHAIN_PROJECT
LANGSMITH_TENANT_ID=$LANGCHAIN_TENANT_ID

# Prometheus
KIKI_PROMETHEUS_PORT=9090
KIKI_METRICS_PATH=/metrics

# ========== 对象存储配置 ==========
# 存储类型: local, minio, cos, base64
KIKI_STORAGE_TYPE=local

# MinIO 配置
KIKI_MINIO_ENDPOINT=localhost:9000
KIKI_MINIO_PUBLIC_ENDPOINT=
KIKI_MINIO_ACCESS_KEY_ID=minioadmin
KIKI_MINIO_SECRET_ACCESS_KEY=minioadmin
KIKI_MINIO_BUCKET_NAME=kiki
KIKI_MINIO_PATH_PREFIX=
KIKI_MINIO_USE_SSL=false

# 腾讯云 COS 配置
KIKI_COS_SECRET_ID=
KIKI_COS_SECRET_KEY=
KIKI_COS_REGION=
KIKI_COS_BUCKET_NAME=
KIKI_COS_APP_ID=
KIKI_COS_PATH_PREFIX=
KIKI_COS_ENABLE_OLD_DOMAIN=true

# 本地存储配置
KIKI_LOCAL_STORAGE_BASE_DIR=./data/files

# ========== 会话上下文配置 ==========
# 上下文存储类型: memory, redis
KIKI_CONTEXT_STORAGE_TYPE=memory
# 上下文过期时间（小时）
KIKI_CONTEXT_TTL_HOURS=24
# 最大消息数量（滑动窗口）
KIKI_CONTEXT_MAX_MESSAGES=100
# 最大 Token 数量
KIKI_CONTEXT_MAX_TOKENS=128000

# ========== Agent 配置 ==========
# 消息滑动窗口大小（超过此数量自动修剪，保留最近的消息）
KIKI_AGENT_MAX_MESSAGES=100
# Agent 最大迭代次数（防止无限循环）
KIKI_AGENT_MAX_ITERATIONS=50
# Agent 默认重试次数
KIKI_AGENT_MAX_RETRIES=3
# Agent 重试初始间隔（秒）
KIKI_AGENT_RETRY_INITIAL_INTERVAL=0.5
# Agent 重试退避因子
KIKI_AGENT_RETRY_BACKOFF_FACTOR=2.0
# Agent 重试最大间隔（秒）
KIKI_AGENT_RETRY_MAX_INTERVAL=60.0

# ========== RAG / Embedding 配置 ==========
# Embedding 提供商: openai, dashscope, voyage, ollama
KIKI_EMBEDDING_PROVIDER=openai
# Embedding 模型名称
# - OpenAI: text-embedding-3-small, text-embedding-3-large
# - DashScope: text-embedding-v4 (Qwen, 支持 1024/1536/2048 维)
# - Voyage: voyage-3-large
KIKI_EMBEDDING_MODEL=text-embedding-3-small
# 向量维度 (text-embedding-v4 支持 64/128/256/512/768/1024/1536/2048)
KIKI_EMBEDDING_DIMENSIONS=1024
# 向量存储类型: pgvector, pinecone, chroma, memory
KIKI_VECTOR_STORE_TYPE=memory

# RAG 分块配置
KIKI_RAG_CHUNK_SIZE=1000
KIKI_RAG_CHUNK_OVERLAP=200
KIKI_RAG_TOP_K=5
KIKI_RAG_SCORE_THRESHOLD=0.7

# DashScope (阿里云) Embedding 配置
# 获取 API Key: https://bailian.console.aliyun.com/
# KIKI_EMBEDDING_PROVIDER=dashscope
# KIKI_EMBEDDING_MODEL=text-embedding-v4
# KIKI_DASHSCOPE_API_KEY=your-dashscope-api-key-here

# Pinecone 配置
# KIKI_PINECONE_API_KEY=your-pinecone-api-key-here
# KIKI_PINECONE_INDEX_NAME=kiki

# Chroma 配置
# KIKI_CHROMA_PERSIST_DIRECTORY=./data/chroma

# ========== Docker 部署配置 ==========
# 是否等待依赖服务启动
WAIT_FOR_DEPS=false
# 是否运行数据库迁移
RUN_MIGRATIONS=false
